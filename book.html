<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href= "https://unpkg.com/purecss@2.0.5/build/pure-min.css" integrity= "sha384-LTIDeidl25h2dPxrB2Ekgc9c7sEC3CWGM6HeFmuDNUjX76Ert4Z4IY714dhZHPLd" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="js/api.js"></script>
  </head>
  <body>
    <h1 class="center">Willkommen!</h1>
    <h2 class="center">Bitte Karte auflegen oder Namen ausw√§hlen.</h2>
    <h3 class="center" id="scanner"></h3>
    <hr>
    <div class="pure-g" id="user-grid">
    </div>
    <script>
        grid = document.getElementById("user-grid");
     
        users = get_users();
        
        for (i = 0; i < users.length; i++) {
            // our grid element
            let gridElement = document.createElement("div");
            gridElement.className = "pure-u-1-3";
            
            // our name
            let name = document.createElement("div");
            name.innerHTML = users[i].name;
            name.classList.add("user-button");
            name.onclick = () => add_drink(name);
            
            gridElement.appendChild(name);
            grid.appendChild(gridElement);
            
        }
    </script>
    <script>
        // weird ringpuffer
        var buffer = new Array()
        buffer.push = function (){
            if (this.length >= 36) {
                this.shift();
            }
            return Array.prototype.push.apply(this,arguments);
        }
        
        // Keylistener for UUIDs/Barcodes
        document.addEventListener('keydown', logKey);
        scannerElement = document.getElementById('scanner');

        function logKey(e) {
            scannerElement.style.display = "block";
            buffer.push(String.fromCharCode(e.keyCode));
            scannerElement.innerHTML = "ID: " + buffer.join('');
            
            // hide element after some time
            setTimeout(function() {
                scannerElement.style.display = "none";
                buffer.length = 0;
            }, 2000);

        }
    </script>
  </body>
</html>
